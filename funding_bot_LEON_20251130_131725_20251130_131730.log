13:17:30 [INFO]  CONFIG VALIDIERUNG abgeschlossen.
13:17:30 [DEBUG] Using selector: SelectSelector
13:17:30 [INFO]  üî• BOT V4 (Full Architected) STARTING...
13:17:30 [INFO] üöÄ Starting InMemoryStateManager...
13:17:30 [INFO] üìÇ Initializing database: data/trades.db
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A5BC0>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A5BC0> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC5E0>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC5E0>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A5F80>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A5F80> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC8B0>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC8B0>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A6160>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A6160> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630ACD60>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630ACD60>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A59E0>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A59E0> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD300>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD300>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A6520>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A6520> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD6C0>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD6C0>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [INFO] ‚úÖ Read pool created: 5 connections
13:17:30 [DEBUG] executing <function connect.<locals>.connector at 0x000001BB630A6340>
13:17:30 [DEBUG] operation <function connect.<locals>.connector at 0x000001BB630A6340> completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA foreign_keys=ON', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA foreign_keys=ON', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA journal_mode=WAL', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA journal_mode=WAL', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA synchronous=NORMAL', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, 'PRAGMA synchronous=NORMAL', []) completed
13:17:30 [INFO] ‚úÖ WAL mode enabled
13:17:30 [INFO] üîÑ Running database migrations...
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, "\n            CREATE TABLE IF NOT EXISTS trades (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                side_x10 TEXT NOT NULL,\n                side_lighter TEXT NOT NULL,\n                size_usd REAL NOT NULL,\n                entry_price_x10 REAL,\n                entry_price_lighter REAL,\n                status TEXT DEFAULT 'open',\n                is_farm_trade INTEGER DEFAULT 0,\n                created_at INTEGER NOT NULL,\n                closed_at INTEGER,\n                pnl REAL DEFAULT 0,\n                funding_collected REAL DEFAULT 0,\n                account_label TEXT,\n                x10_order_id TEXT,\n                lighter_order_id TEXT,\n                UNIQUE(symbol, status) ON CONFLICT REPLACE\n            )\n            ", [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, "\n            CREATE TABLE IF NOT EXISTS trades (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                side_x10 TEXT NOT NULL,\n                side_lighter TEXT NOT NULL,\n                size_usd REAL NOT NULL,\n                entry_price_x10 REAL,\n                entry_price_lighter REAL,\n                status TEXT DEFAULT 'open',\n                is_farm_trade INTEGER DEFAULT 0,\n                created_at INTEGER NOT NULL,\n                closed_at INTEGER,\n                pnl REAL DEFAULT 0,\n                funding_collected REAL DEFAULT 0,\n                account_label TEXT,\n                x10_order_id TEXT,\n                lighter_order_id TEXT,\n                UNIQUE(symbol, status) ON CONFLICT REPLACE\n            )\n            ", []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_symbol ON trades(symbol)\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_symbol ON trades(symbol)\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_status ON trades(status)\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_status ON trades(status)\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_created ON trades(created_at)\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_trades_created ON trades(created_at)\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS funding_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                exchange TEXT NOT NULL,\n                rate REAL NOT NULL,\n                timestamp INTEGER NOT NULL,\n                collected_amount REAL DEFAULT 0\n            )\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS funding_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                exchange TEXT NOT NULL,\n                rate REAL NOT NULL,\n                timestamp INTEGER NOT NULL,\n                collected_amount REAL DEFAULT 0\n            )\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_funding_symbol_ts \n            ON funding_history(symbol, timestamp)\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_funding_symbol_ts \n            ON funding_history(symbol, timestamp)\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS execution_log (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                action TEXT NOT NULL,\n                exchange TEXT NOT NULL,\n                success INTEGER NOT NULL,\n                order_id TEXT,\n                error TEXT,\n                latency_ms REAL,\n                timestamp INTEGER NOT NULL\n            )\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS execution_log (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT NOT NULL,\n                action TEXT NOT NULL,\n                exchange TEXT NOT NULL,\n                success INTEGER NOT NULL,\n                order_id TEXT,\n                error TEXT,\n                latency_ms REAL,\n                timestamp INTEGER NOT NULL\n            )\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS bot_state (\n                key TEXT PRIMARY KEY,\n                value TEXT NOT NULL,\n                updated_at INTEGER NOT NULL\n            )\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS bot_state (\n                key TEXT PRIMARY KEY,\n                value TEXT NOT NULL,\n                updated_at INTEGER NOT NULL\n            )\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS pnl_snapshots (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                timestamp INTEGER NOT NULL,\n                total_pnl REAL NOT NULL,\n                unrealized_pnl REAL NOT NULL,\n                realized_pnl REAL NOT NULL,\n                funding_pnl REAL NOT NULL,\n                trade_count INTEGER NOT NULL\n            )\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS pnl_snapshots (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                timestamp INTEGER NOT NULL,\n                total_pnl REAL NOT NULL,\n                unrealized_pnl REAL NOT NULL,\n                realized_pnl REAL NOT NULL,\n                funding_pnl REAL NOT NULL,\n                trade_count INTEGER NOT NULL\n            )\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_pnl_ts ON pnl_snapshots(timestamp)\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE INDEX IF NOT EXISTS idx_pnl_ts ON pnl_snapshots(timestamp)\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS _migrations (\n                id INTEGER PRIMARY KEY,\n                name TEXT NOT NULL,\n                applied_at INTEGER NOT NULL\n            )\n            ', [])
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AD990>, '\n            CREATE TABLE IF NOT EXISTS _migrations (\n                id INTEGER PRIMARY KEY,\n                name TEXT NOT NULL,\n                applied_at INTEGER NOT NULL\n            )\n            ', []) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BB630AD990>)
13:17:30 [DEBUG] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BB630AD990>) completed
13:17:30 [INFO] ‚úÖ Migrations complete (11 statements)
13:17:30 [INFO] ‚úÖ Database initialized
13:17:30 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC5E0>, "SELECT * FROM trades WHERE status = 'open' ORDER BY created_at DESC", ())
13:17:30 [INFO] üñäÔ∏è Database write loop started
13:17:30 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BB630AC5E0>, "SELECT * FROM trades WHERE status = 'open' ORDER BY created_at DESC", ()) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001BB61091540>)
13:17:30 [DEBUG] operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001BB61091540>) completed
13:17:30 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001BB61091540>)
13:17:30 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001BB61091540>) completed
13:17:30 [INFO] üìÇ Loaded 3 trades from database
13:17:30 [INFO] ‚úÖ InMemoryStateManager started (loaded 3 trades)
13:17:30 [INFO] ‚úÖ State Manager started
13:17:30 [INFO]  Telegram Bot disabled (Token/ChatID missing).
13:17:30 [INFO] üìù State writer loop started
13:17:30 [INFO] üìù State writer loop stopped
13:17:30 [INFO] üñäÔ∏è Database write loop stopped
