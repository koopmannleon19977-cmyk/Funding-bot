14:36:04 [INFO]  CONFIG VALIDIERUNG abgeschlossen.
14:36:04 [INFO]  🔥 BOT V4 (Full Architected) STARTING...
14:36:04 [INFO] InMemoryStateManager initialized
14:36:04 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, "\n                CREATE TABLE IF NOT EXISTS trades (\n                    symbol TEXT PRIMARY KEY,\n                    entry_time TIMESTAMP,\n                    notional_usd REAL,\n                    status TEXT DEFAULT 'OPEN',\n                    leg1_exchange TEXT,\n                    initial_spread_pct REAL,\n                    initial_funding_rate_hourly REAL,\n                    entry_price_x10 REAL,\n                    entry_price_lighter REAL,\n                    funding_flip_start_time TIMESTAMP,\n                    is_farm_trade BOOLEAN DEFAULT FALSE,\n                    account_label TEXT\n                )\n            ", [])
14:36:04 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, "\n                CREATE TABLE IF NOT EXISTS trades (\n                    symbol TEXT PRIMARY KEY,\n                    entry_time TIMESTAMP,\n                    notional_usd REAL,\n                    status TEXT DEFAULT 'OPEN',\n                    leg1_exchange TEXT,\n                    initial_spread_pct REAL,\n                    initial_funding_rate_hourly REAL,\n                    entry_price_x10 REAL,\n                    entry_price_lighter REAL,\n                    funding_flip_start_time TIMESTAMP,\n                    is_farm_trade BOOLEAN DEFAULT FALSE,\n                    account_label TEXT\n                )\n            ", []) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, '\n                CREATE TABLE IF NOT EXISTS trade_history (\n                    id INTEGER PRIMARY KEY AUTOINCREMENT,\n                    symbol TEXT,\n                    entry_time TIMESTAMP,\n                    exit_time TIMESTAMP,\n                    hold_duration_hours REAL,\n                    close_reason TEXT,\n                    final_pnl_usd REAL,\n                    funding_pnl_usd REAL,\n                    spread_pnl_usd REAL,\n                    fees_usd REAL,\n                    account_label TEXT\n                )\n            ', [])
14:36:04 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, '\n                CREATE TABLE IF NOT EXISTS trade_history (\n                    id INTEGER PRIMARY KEY AUTOINCREMENT,\n                    symbol TEXT,\n                    entry_time TIMESTAMP,\n                    exit_time TIMESTAMP,\n                    hold_duration_hours REAL,\n                    close_reason TEXT,\n                    final_pnl_usd REAL,\n                    funding_pnl_usd REAL,\n                    spread_pnl_usd REAL,\n                    fees_usd REAL,\n                    account_label TEXT\n                )\n            ', []) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE60805030>)
14:36:04 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE60805030>) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, "SELECT * FROM trades WHERE status = 'OPEN'", [])
14:36:04 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE60805030>, "SELECT * FROM trades WHERE status = 'OPEN'", []) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001AE607E9B40>)
14:36:04 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001AE607E9B40>) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE60805030>)
14:36:04 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE60805030>) completed
14:36:04 [INFO] Loaded 0 open trades into RAM
14:36:04 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001AE607E9B40>)
14:36:04 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001AE607E9B40>) completed
14:36:04 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608053F0>)
14:36:04 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608053F0>) completed
14:36:04 [INFO] Loaded 0 fee stats into cache
14:36:04 [INFO] Background writer started
14:36:05 [INFO] ✅ State Manager background writer started
14:36:05 [INFO]  Telegram Bot disabled (Token/ChatID missing).
14:36:05 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608056C0>, "\n            CREATE TABLE IF NOT EXISTS trades (\n                symbol TEXT PRIMARY KEY,\n                entry_time TIMESTAMP,\n                notional_usd REAL,\n                status TEXT DEFAULT 'OPEN',\n                leg1_exchange TEXT,\n                initial_spread_pct REAL,\n                initial_funding_rate_hourly REAL,\n                entry_price_x10 REAL,\n                entry_price_lighter REAL,\n                funding_flip_start_time TIMESTAMP,\n                is_farm_trade BOOLEAN DEFAULT FALSE,\n                account_label TEXT\n            )\n        ", [])
14:36:05 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608056C0>, "\n            CREATE TABLE IF NOT EXISTS trades (\n                symbol TEXT PRIMARY KEY,\n                entry_time TIMESTAMP,\n                notional_usd REAL,\n                status TEXT DEFAULT 'OPEN',\n                leg1_exchange TEXT,\n                initial_spread_pct REAL,\n                initial_funding_rate_hourly REAL,\n                entry_price_x10 REAL,\n                entry_price_lighter REAL,\n                funding_flip_start_time TIMESTAMP,\n                is_farm_trade BOOLEAN DEFAULT FALSE,\n                account_label TEXT\n            )\n        ", []) completed
14:36:05 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608056C0>, '\n            CREATE TABLE IF NOT EXISTS trade_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT,\n                entry_time TIMESTAMP,\n                exit_time TIMESTAMP,\n                hold_duration_hours REAL,\n                close_reason TEXT,\n                final_pnl_usd REAL,\n                funding_pnl_usd REAL,\n                spread_pnl_usd REAL,\n                fees_usd REAL,\n                account_label TEXT\n            )\n        ', [])
14:36:05 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608056C0>, '\n            CREATE TABLE IF NOT EXISTS trade_history (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                symbol TEXT,\n                entry_time TIMESTAMP,\n                exit_time TIMESTAMP,\n                hold_duration_hours REAL,\n                close_reason TEXT,\n                final_pnl_usd REAL,\n                funding_pnl_usd REAL,\n                spread_pnl_usd REAL,\n                fees_usd REAL,\n                account_label TEXT\n            )\n        ', []) completed
14:36:05 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608056C0>)
14:36:05 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608056C0>) completed
14:36:05 [DEBUG] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608055D0>, 'PRAGMA table_info(trade_history)', [])
14:36:05 [DEBUG] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001AE608055D0>, 'PRAGMA table_info(trade_history)', []) completed
14:36:05 [DEBUG] executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608055D0>)
14:36:05 [DEBUG] operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001AE608055D0>) completed
14:36:05 [INFO] Initialisiere X10 Adapter...
14:36:05 [INFO] ✅ X10 Account initialisiert.
14:36:05 [INFO] Initialisiere Lighter Adapter...
14:36:05 [INFO] 📊 Loading Market Data...
14:36:06 [INFO] ✅ Lighter: Loaded 111 markets
14:36:06 [INFO] Account Manager initialized: 1 X10, 1 Lighter accounts
14:36:06 [INFO] Lighter: Using account index 60113
14:36:07 [INFO] ✅ X10: Loaded 91 markets, 91 funding rates, 78 prices
14:36:07 [INFO] ✅ Markets loaded: X10=91, Lighter=111
14:36:07 [INFO] 📈 Loading initial funding rates...
14:36:07 [INFO] ✅ Data OK: BTC-USD X10=$91614.28, Lighter=$0.00
14:36:07 [INFO] 🌐 Starting WebSocket streams...
14:36:07 [INFO] FundingPredictorV2 → FINAL BULLETPROOF VERSION
14:36:07 [INFO] WebSocket Manager: Starting streams for 2 adapters...
14:36:07 [INFO] ✅ WebSocket Manager: Started stream for X10
14:36:07 [INFO] ✅ WebSocket Manager: Started stream for Lighter
14:36:07 [INFO] WebSocket Manager: 2 streams initialized.
14:36:07 [INFO] 🔍 STATE RECONCILIATION: Checking DB vs Exchange...
14:36:07 [INFO] ✓ No DB trades to reconcile
14:36:07 [INFO] 🌐 Lighter: Connecting to wss://mainnet.zklighter.elliot.ai/stream...
14:36:07 [INFO] 🌐 X10: Connecting to Orderbook Stream...
14:36:07 [INFO] 🌐 X10: Connecting to Funding Stream...
14:36:08 [DEBUG] = connection is OPEN
14:36:08 [INFO] ✅ X10: Orderbook Stream connected!
14:36:09 [DEBUG] = connection is OPEN
14:36:09 [INFO] ✅ Lighter: WebSocket connected
14:36:09 [DEBUG] = connection is OPEN
14:36:09 [INFO] 🔍 Lighter Init: {'session_id': '3a71f013-56d3-4ea6-bea3-b9a1ccb30148', 'type': 'connected'}
14:36:09 [INFO] ✅ X10: Funding Stream connected!
14:36:09 [INFO] X10: Subscribed to 91 markets
14:36:15 [INFO] ⏳ Waiting for WebSocket connections...
14:36:22 [INFO] Starting emergency_position_cleanup (interval=3600s, max_age_hours=48.0)
14:36:28 [INFO] 🔍 Verifying WebSocket health...
14:36:41 [INFO] 📊 Cache status: X10=78 prices, Lighter=0 prices
14:36:41 [INFO] ✅ WebSocket streams healthy - receiving price updates
14:36:41 [INFO] 📊 Refreshing missing prices...
